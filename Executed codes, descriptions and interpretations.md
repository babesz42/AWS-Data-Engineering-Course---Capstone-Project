# Executed codes, explonations and interpretations
I will now interpret the queries I have ran in Athena. The codes that I have ran in the Cloud9 IDE are written in the other file and those are also pretty self explanatory.
For the query interpretations each I have written 3 sentences, where in the first one I explain the query, in the second I analyse the first row of the output and in the third one I interpret the whole result set.

# Queries in the lab
## Query 1
```
SELECT year, fishing_entity AS Country, CAST(CAST(SUM(landed_value) AS DOUBLE) AS DECIMAL(38,2)) AS ValueAllHighSeasCatch
FROM fishdb.data_source_6769
WHERE area_name IS NULL and fishing_entity='Fiji' AND year > 2000
GROUP BY year, fishing_entity
ORDER By year
```
This SQL query calculates the total yearly revenue generated by Fiji's fishing fleet in international high seas waters from 2001 onwards by summing the landed value where no specific area name is assigned. The first result shows that at the start of this period in 2001, Fiji's catch value was approximately $65.5 million. Viewing the dataset as a whole, the output demonstrates a remarkably stable industry, with annual revenues consistently remaining within the $61 million to $73 million range over nearly two decades.

## Query 2
```
SELECT DISTINCT area_name FROM fishdb.data_source_6769;
```
This query isolates the unique entries in the `area_name` column to determine the specific geographical regions represented in the dataset. The first result displays "Pacific, Western Central," which corresponds to the open seas portion of the study. Overall, the output confirms that the data is partitioned into exactly two distinct categories, facilitating a direct comparison between this high seas region and the Fiji Exclusive Economic Zone.

## Query 3
```
SELECT year, fishing_entity AS Country, CAST(CAST(SUM(landed_value) AS DOUBLE) AS DECIMAL(38,2)) AS ValueOpenSeasCatch 
FROM fishdb.data_source_6769
WHERE area_name IS NULL AND fishing_entity='Fiji' AND year > 2000
GROUP BY year, fishing_entity
ORDER By year
```
This query calculates the annual aggregate economic value of Fiji's fishing catch specifically within Open Seas regions—identified by null area records—for the period following the year 2000. The initial data point for 2001 establishes a baseline revenue of approximately $65.5 million generated from these waters. Viewed holistically, the dataset demonstrates the enduring stability of this sector, with annual revenues consistently fluctuating within a defined range of $61 million to $73 million over the nearly two-decade span.

## Query 4
```
SELECT year, fishing_entity AS Country, CAST(CAST(SUM(landed_value) AS DOUBLE) AS DECIMAL(38,2)) AS ValueEEZCatch
FROM fishdb.data_source_6769
WHERE area_name LIKE '%Fiji%' AND fishing_entity='Fiji' AND year > 2000
GROUP BY year, fishing_entity
ORDER By year
```
This query targets the domestic fishery sector by aggregating the landed value of catches specifically within Fiji’s Exclusive Economic Zone (EEZ) for the years subsequent to 2000. The data for the first recorded year, 2001, reveals an initial valuation of approximately $62.5 million within these territorial waters. Unlike the high seas data, the EEZ valuation demonstrates notable fluctuation over the period, reaching a significant peak of $86.8 million in 2007 before declining to a low of $50.2 million in 2013 and subsequently recovering.

## Query 5
```
CREATE OR REPLACE VIEW MackerelsCatch AS
SELECT year, area_name AS WhereCaught, fishing_entity as Country, SUM(tonnes) AS TotalWeight
FROM fishdb.data_source_6769
WHERE common_name LIKE '%Mackerels%' AND year > 2014
GROUP BY year, area_name, fishing_entity, tonnes
ORDER BY tonnes DESC
```
This statement establishes a reusable view named MackerelsCatch designed to isolate and aggregate catch data specifically for Mackerel species from 2015 onwards. The system response "Query successful" serves as the immediate confirmation that the database has validated the syntax and successfully registered the view structure in the catalog. Functionally, this abstraction layer now permits the execution of complex queries on Mackerel stocks through a simplified interface, removing the need to repeatedly specify the underlying filtering and aggregation rules.

## Query 6
```
SELECT * FROM "fishdb"."mackerelscatch" limit 10;
```
This query queries the previously defined MackerelsCatch view to isolate the ten most significant individual catch records for Mackerel species in the years following 2014. The data reveals that the highest recorded volume occurred in 2015, where the United States reported a catch of approximately 859.5 tonnes in the Pacific Western Central region. Collectively, the results highlight a clear division in fishing activity, with the United States dominating high-volume catches in open international waters, whereas Fiji’s significant catches are exclusively concentrated within its own territorial boundaries.

## Query 7
```
SELECT year, Country, MAX(TotalWeight) AS Weight
FROM fishdb.mackerelscatch 
GROUP BY year, Country
ORDER BY year, Weight DESC;
```
This query aggregates the maximum recorded weight of Mackerel catches for each fishing entity on an annual basis to identify the dominant market participants since 2015. The initial result highlights the United States' dominance in the 2015 season, where it secured the highest single catch volume of approximately 859.5 tonnes. Over the observed four-year period, the dataset illustrates a competitive duopoly where the United States and Fiji consistently vie for the top position, collectively dwarfing the contributions of other nations such as Indonesia and Vietnam, whose catch volumes remain comparatively marginal.

## Query 8
```
SELECT * FROM "fishdb"."mackerelscatch" 
where country in ('China')
```
This query filters the MackerelsCatch view to isolate and examine the specific fishing activities of China across both open seas and Fijian waters. The first record indicates that China’s peak performance occurred in 2017 within the Pacific Western Central region, where it landed a total catch of approximately 96.4 tonnes. A closer examination of the output reveals a distinct upward trend in China’s engagement in the region, with catch volumes in both the open ocean and the Fiji EEZ growing substantially from modest figures in 2015 to nearly 100 tonnes by 2017.


# Own queries
## Query 1
```
SELECT common_name AS Species, SUM(tonnes) AS TotalWeight, CAST(SUM(landed_value) AS DECIMAL(38,2)) AS TotalRevenue
FROM fishdb.data_source_6769
WHERE year = 2018
GROUP BY common_name
ORDER BY TotalRevenue DESC
LIMIT 5;
```
This query aggregates the landed value and total weight for each species in 2018 to rank the top five most economically significant fish types. While the data contains a large volume of unclassified catch in the first row, the specific results reveal that Skipjack Tuna is the most valuable identified species, generating a massive revenue of over $68.5 billion. Viewed collectively, the results highlight that the market is driven heavily by tuna species (Skipjack, Yellowfin, Bigeye, and Albacore), which account for the entire top-tier of the industry's value. This analysis is particularly useful for fisheries economists and policy regulators, as it pinpoints exactly which species drive the financial incentives for fishing fleets, helping to prioritize sustainability efforts where the profit margins are highest.

## Query 2
```
SELECT fishing_entity AS Country, SUM(tonnes) AS TotalHighSeasCatch
FROM fishdb.data_source_6769
WHERE area_name IS NULL AND year >= 2008
GROUP BY fishing_entity
ORDER BY TotalHighSeasCatch DESC
LIMIT 5;
```
This query calculates the total catch volume in Open Seas areas (where no specific country has jurisdiction) for the last decade, ranking the top five nations by fishing intensity. The data shows that China is the dominant actor in international waters, responsible for harvesting roughly 167 million tonnes of fish since 2008—nearly double that of the next closest nation. The overall ranking suggests a concentration of power where a small number of nations—primarily China, the Russian Federation, and Peru—harvest the vast majority of high seas resources. This insight is critical for international bodies like the UN or WTO, as it identifies the key stakeholders who must be engaged in negotiations regarding high-seas biodiversity treaties and subsidy reductions.

## Query 3
```
SELECT year, CAST(SUM(landed_value) / SUM(tonnes) AS DECIMAL(10,2)) AS AveragePricePerTonne
FROM fishdb.data_source_6769
GROUP BY year
ORDER BY year ASC;
```
This query computes the average "efficiency" of the fishery by dividing total revenue by total weight for each year, effectively calculating the average market price per tonne of fish over the entire dataset. The starting year (1950) shows an average value of $1,483.85 per tonne, setting the historical baseline for the market. Looking at the trend line, the data reveals a consistent upward trajectory, with the price per tonne rising to over $2,215 by 2018, indicating that fish have become significantly more expensive relative to volume over time. This metric is valuable for market analysts and investors, as the rising price-per-tonne signals increasing resource scarcity and higher demand, suggesting that the fishing industry is shifting from a volume-based model to a value-based one.







